

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Finite-dimensional Hilbert spaces &mdash; libcommute 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css?v=9bead9b5" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Linear operators" href="loperator.html" />
    <link rel="prev" title="Introduction" href="intro.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            libcommute
              <img src="../_static/logo_small.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">How to use <em>libcommute</em> in your project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../expression/index.html">Domain-Specific Language for polynomial expressions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tools for exact diagonalization</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Finite-dimensional Hilbert spaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE"><code class="docutils literal notranslate"><span class="pre">hilbert_space</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0Dp0EN10libcommute18make_hilbert_spaceE13hilbert_spaceIDp10IndexTypesERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor"><code class="docutils literal notranslate"><span class="pre">make_hilbert_space()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elementary-spaces">Elementary spaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-customization-of-automatic-hilbert-space-construction">Advanced: Customization of automatic Hilbert space construction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="loperator.html">Linear operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="monomial_action.html">Advanced: Linear operator representation of a user-defined algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="state_vector.html">State vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="space_partition.html">Finding invariant subspaces of a linear operator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Advanced examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../search.html">Search Page</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">libcommute</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Tools for exact diagonalization</a></li>
      <li class="breadcrumb-item active">Finite-dimensional Hilbert spaces</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/loperator/hilbert_space.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="finite-dimensional-hilbert-spaces">
<span id="hilbert-space"></span><h1>Finite-dimensional Hilbert spaces<a class="headerlink" href="#finite-dimensional-hilbert-spaces" title="Link to this heading"></a></h1>
<p>Class <a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">hilbert_space</span></code></a> is an abstraction of a finite-dimensional state
space of a quantum system. It contains information needed to construct a
<a class="reference internal" href="loperator.html#loperator"><span class="std std-ref">linear operator object</span></a> out of a
<a class="reference internal" href="../expression/expression.html#expression"><span class="std std-ref">polynomial expression</span></a>.</p>
<p>A <a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">hilbert_space</span></code></a> is defined as an (ordered) direct product of
<a class="reference internal" href="#elementary-spaces"><span class="std std-ref">elementary spaces</span></a> <span class="math notranslate nohighlight">\(\mathcal{H}_i\)</span>,</p>
<div class="math notranslate nohighlight">
\[\mathcal{H} = \mathcal{H}_1 \otimes \mathcal{H}_2 \otimes \ldots \otimes
              \mathcal{H}_N.\]</div>
<p>An elementary space associated with an <a class="reference internal" href="../expression/generator.html#generator"><span class="std std-ref">algebra generator</span></a>
<span class="math notranslate nohighlight">\(g\)</span> is a vector space of dimension <span class="math notranslate nohighlight">\(d \geq 1\)</span>.
For instance, an elementary space associated with a fermionic
creation/annihilation operator is two-dimensional; It is spanned by the
occupation number states <span class="math notranslate nohighlight">\(|0\rangle\)</span> and <span class="math notranslate nohighlight">\(|1\rangle\)</span>.
For a spin-1 operator, we have a 3-dimensional elementary space.
There are three basis vectors of the irreducible representation,
<span class="math notranslate nohighlight">\(|m=0\rangle\)</span>, <span class="math notranslate nohighlight">\(|m=\pm 1\rangle\)</span>. Finally, in the case of a bosonic
generator one has to truncate the infinite-dimensional state space and manually
set <span class="math notranslate nohighlight">\(d\geq 1\)</span> (<span class="math notranslate nohighlight">\(d = 2\)</span> would correspond to a hardcore boson with two
allowed states <span class="math notranslate nohighlight">\(|0\rangle\)</span> and <span class="math notranslate nohighlight">\(|1\rangle\)</span>).</p>
<p>The ordering of the elementary spaces in the product is established by the
algebra IDs of the generators <span class="math notranslate nohighlight">\(g\)</span> these spaces are associated with
(the smaller algebra ID comes first). Two elementary spaces sharing the same ID
are ordered according to the <a class="reference internal" href="#elementary-spaces"><span class="std std-ref">rules specific to the corresponding
algebra</span></a>.</p>
<p>Basis states of the full space <span class="math notranslate nohighlight">\(\mathcal{H}\)</span> are enumerated in the
following way. Each basis state of <span class="math notranslate nohighlight">\(\mathcal{H}\)</span> is a direct product of
basis vectors of the elementary spaces,</p>
<div class="math notranslate nohighlight">
\[|n\rangle_\mathcal{H} = |n_1\rangle_{\mathcal{H}_1} \otimes
                        |n_2\rangle_{\mathcal{H}_2} \otimes\ldots\otimes
                        |n_N\rangle_{\mathcal{H}_N}.\]</div>
<p>In the code, the basis vectors are represented by 64-bit unsigned integers
(<a class="reference internal" href="state_vector.html#_CPPv4N10libcommute13sv_index_typeE" title="libcommute::sv_index_type"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">sv_index_type</span></code></a>).
The binary form of <span class="math notranslate nohighlight">\(|n\rangle_\mathcal{H}\)</span> is
then a concatenation of binary forms of <span class="math notranslate nohighlight">\(|n_i\rangle_{\mathcal{H}_i}\)</span>.
For example, the following picture shows memory representation of the basis
state <span class="math notranslate nohighlight">\(|90\rangle_\mathcal{H} = |0\rangle_{\mathcal{H}_1} \otimes
|5\rangle_{\mathcal{H}_2} \otimes |1\rangle_{\mathcal{H}_3} \otimes
|1\rangle_{\mathcal{H}_4}\)</span>.</p>
<a class="reference internal image-reference" href="../_images/basis_state.svg"><img alt="../_images/basis_state.svg" src="../_images/basis_state.svg" style="width: 800px;" />
</a>
<p>Cells (bits) of the same color belong to the same elementary space and the
higher blank cells 7-62 are unused – set to zero. The most significant bit 63
is reserved and can never be occupied by an elementary space. This restriction
is necessary to make sure that the size of a Hilbert space with all the allowed
63 bits used up is still representable by a value of the type
<a class="reference internal" href="state_vector.html#_CPPv4N10libcommute13sv_index_typeE" title="libcommute::sv_index_type"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">sv_index_type</span></code></a>.</p>
<p id="sparse-hilbert-space">A note should be made about the elementary spaces, whose dimension is not a
power of 2. Those occupy <span class="math notranslate nohighlight">\(b = \lceil\log_2(d)\rceil\)</span> bits in the binary
representation of a basis state, which means that <span class="math notranslate nohighlight">\(2^b - d\)</span> of the
corresponding binary strings do not represent valid basis states. Such strings
are never referenced in <em>libcommute</em>’s algorithms and have no effect on the
calculation results. Nonetheless, the size of a
<a class="reference internal" href="state_vector.html#state-vector"><span class="std std-ref">state vector</span></a> container compatible with the Hilbert space
<span class="math notranslate nohighlight">\(\mathcal{H}\)</span> <strong>must still be at least</strong> <span class="math notranslate nohighlight">\(\prod_{i=1}^N 2^{b_i}\)</span>,
which exceeds <span class="math notranslate nohighlight">\(\dim(\mathcal{H}) = \prod_{i=1}^N d_i\)</span> as soon as there is
at least one elementary space with a non-power-of-two dimension. We call such
<a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">hilbert_space</span></code></a> objects sparse.</p>
<p>The simplest way to construct a <a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">hilbert_space</span></code></a> object is by calling
<a class="reference internal" href="#_CPPv4I0Dp0EN10libcommute18make_hilbert_spaceE13hilbert_spaceIDp10IndexTypesERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor" title="libcommute::make_hilbert_space"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">make_hilbert_space()</span></code></a> on an expression.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">libcommute</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">static_indices</span><span class="p">;</span><span class="w"> </span><span class="c1">// For n()</span>

<span class="k">auto</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="p">(</span><span class="s">&quot;up&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="p">(</span><span class="s">&quot;dn&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>

<span class="c1">// Construct a 4-dimensional Hilbert space, which is a product of two</span>
<span class="c1">// fermionic elementary spaces (for {&quot;up&quot;, 0} and {&quot;dn&quot;, 0}).</span>
<span class="k">auto</span><span class="w"> </span><span class="n">hs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_hilbert_space</span><span class="p">(</span><span class="n">H</span><span class="p">);</span>
</pre></div>
</div>
<p><a class="reference internal" href="#_CPPv4I0Dp0EN10libcommute18make_hilbert_spaceE13hilbert_spaceIDp10IndexTypesERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor" title="libcommute::make_hilbert_space"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">make_hilbert_space()</span></code></a> is a convenience function that forwards its
arguments to one of <a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">hilbert_space</span></code></a>’s constructors. That constructor
iterates over all generators found in the expression and adds their associated
elementary spaces into the product <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>. Sometimes, it may
require extra bits of information to translate a generator into an elementary
space. Perhaps the most prominent example here is a bosonic elementary space,
whose truncated dimension must be set by the user. It is possible to
<a class="reference internal" href="#es-constructor"><span class="std std-ref">customize the Hilbert space construction procedure</span></a>
by passing an extra argument to <a class="reference internal" href="#_CPPv4I0Dp0EN10libcommute18make_hilbert_spaceE13hilbert_spaceIDp10IndexTypesERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor" title="libcommute::make_hilbert_space"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">make_hilbert_space()</span></code></a>. The following
code snippet shows how to set the truncated space dimension for all bosonic
generators at once.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">libcommute</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">static_indices</span><span class="p">;</span><span class="w"> </span><span class="c1">// For a_dag() and a()</span>

<span class="k">auto</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">a_dag</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">3.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">a_dag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="p">);</span>

<span class="c1">// hs is a direct product of two bosonic elementary spaces, each with</span>
<span class="c1">// dimension 16.</span>
<span class="k">auto</span><span class="w"> </span><span class="n">hs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_hilbert_space</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="w"> </span><span class="n">boson_es_constructor</span><span class="p">(</span><span class="mi">16</span><span class="p">));</span>
</pre></div>
</div>
<p>Other, more refined ways to create a Hilbert space are (a) to explicitly provide
a list of elementary spaces or (b) to start from an empty product and add
elementary spaces one by one. One might have to resort to these approaches when
some elementary spaces must be added into the product, but their corresponding
generators are not necessarily found in <code class="docutils literal notranslate"><span class="pre">H</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">libcommute</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">static_indices</span><span class="p">;</span><span class="w"> </span><span class="c1">// For make_space_*()</span>

<span class="c1">// A product of three elementary spaces</span>
<span class="c1">// std::string and int are index types of generators</span>
<span class="n">hilbert_space</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">hs1</span><span class="p">(</span>
<span class="w">  </span><span class="n">make_space_fermion</span><span class="p">(</span><span class="s">&quot;dn&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">   </span><span class="c1">// Fermion</span>
<span class="w">  </span><span class="n">make_space_boson</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;x&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">  </span><span class="c1">// Boson truncated to dim = 16</span>
<span class="w">  </span><span class="n">make_space_spin</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;i&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">   </span><span class="c1">// Spin-1/2</span>
<span class="p">);</span>

<span class="c1">// Empty space, to be filled later</span>
<span class="n">hilbert_space</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">hs2</span><span class="p">;</span>
<span class="c1">// Fill the space</span>
<span class="n">hs2</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">make_space_fermion</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span><span class="w">   </span><span class="c1">// Add a fermion</span>
<span class="n">hs2</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">make_space_boson</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">));</span><span class="w"> </span><span class="c1">// Add a boson</span>
</pre></div>
</div>
<p>The order in which the elementary spaces are passed to the constructor or added
does not matter – they will be reordered automatically.</p>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN10libcommute13hilbert_spaceE">
<span id="_CPPv3IDpEN10libcommute13hilbert_spaceE"></span><span id="_CPPv2IDpEN10libcommute13hilbert_spaceE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">IndexTypes</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hilbert_space</span></span></span><a class="headerlink" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="Link to this definition"></a><br /></dt>
<dd><p><em>Defined in &lt;libcommute/loperator/hilbert_space.hpp&gt;</em></p>
<p>State space of a quantum system as a direct product of
<a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">elementary</span> <span class="pre">spaces</span></code></a>.</p>
<p>Parameter pack <a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space::IndexTypes"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">IndexTypes</span></code></a> must agree with that of
<a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">elementary_space</span></code></a> and/or <a class="reference internal" href="../expression/expression.html#_CPPv4I0DpEN10libcommute10expressionE" title="libcommute::expression"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">libcommute::expression</span></code></a> objects,
which are used to construct this Hilbert space.</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute13hilbert_space11index_typesE">
<span id="_CPPv3N10libcommute13hilbert_space11index_typesE"></span><span id="_CPPv2N10libcommute13hilbert_space11index_typesE"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_types</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">tuple</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N10libcommute13hilbert_space11index_typesE" title="Link to this definition"></a><br /></dt>
<dd><p>Index tuple type.</p>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute13hilbert_space18elementary_space_tE">
<span id="_CPPv3N10libcommute13hilbert_space18elementary_space_tE"></span><span id="_CPPv2N10libcommute13hilbert_space18elementary_space_tE"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">elementary_space_t</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N10libcommute13hilbert_space18elementary_space_tE" title="Link to this definition"></a><br /></dt>
<dd><p>Type of the elementary spaces in the product.</p>
</dd></dl>

<p class="rubric">Constructors</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute13hilbert_space10expressionEv">
<span id="_CPPv3N10libcommute13hilbert_space10expressionEv"></span><span id="_CPPv2N10libcommute13hilbert_space10expressionEv"></span><span id="libcommute::hilbert_space::expression"></span><span class="sig-name descname"><span class="n"><span class="pre">expression</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N10libcommute13hilbert_space10expressionEv" title="Link to this definition"></a><br /></dt>
<dd><p>Construct an empty space.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN10libcommute13hilbert_space13hilbert_spaceEDpRR4Args">
<span id="_CPPv3IDpEN10libcommute13hilbert_space13hilbert_spaceEDpRR4Args"></span><span id="_CPPv2IDpEN10libcommute13hilbert_space13hilbert_spaceEDpRR4Args"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">Args</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hilbert_space</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_space13hilbert_spaceEDpRR4Args" title="libcommute::hilbert_space::hilbert_space::Args"><span class="n"><span class="pre">Args</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">args</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IDpEN10libcommute13hilbert_space13hilbert_spaceEDpRR4Args" title="Link to this definition"></a><br /></dt>
<dd><p>Construct from a list of elementary spaces. The elementary spaces need not
be given in any particular order.
Throws <a class="reference internal" href="#_CPPv4N10libcommute13hilbert_space21hilbert_space_too_bigE" title="libcommute::hilbert_space::hilbert_space_too_big"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">hilbert_space_too_big</span></code></a> if all elementary spaces together
would exceed the 63-bit limit of the basis state index.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN10libcommute13hilbert_space13hilbert_spaceERKN10libcommute10expressionI10ScalarTypeDp10IndexTypesEERR13ESConstructor">
<span id="_CPPv3I00EN10libcommute13hilbert_space13hilbert_spaceERKN10libcommute10expressionI10ScalarTypeDp10IndexTypesEERR13ESConstructor"></span><span id="_CPPv2I00EN10libcommute13hilbert_space13hilbert_spaceERKN10libcommute10expressionI10ScalarTypeDp10IndexTypesEERR13ESConstructor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ScalarType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ESConstructor</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N10libcommute22default_es_constructorE" title="libcommute::default_es_constructor"><span class="n"><span class="pre">default_es_constructor</span></span></a><span class="p"><span class="pre">&gt;</span></span><br /><span class="sig-name descname"><span class="n"><span class="pre">hilbert_space</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">libcommute</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../expression/expression.html#_CPPv4I0DpEN10libcommute10expressionE" title="libcommute::expression"><span class="n"><span class="pre">expression</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN10libcommute13hilbert_space13hilbert_spaceERKN10libcommute10expressionI10ScalarTypeDp10IndexTypesEERR13ESConstructor" title="libcommute::hilbert_space::hilbert_space::ScalarType"><span class="n"><span class="pre">ScalarType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">expr</span></span>, <a class="reference internal" href="#_CPPv4I00EN10libcommute13hilbert_space13hilbert_spaceERKN10libcommute10expressionI10ScalarTypeDp10IndexTypesEERR13ESConstructor" title="libcommute::hilbert_space::hilbert_space::ESConstructor"><span class="n"><span class="pre">ESConstructor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es_constr</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="p"><span class="pre">}</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN10libcommute13hilbert_space13hilbert_spaceERKN10libcommute10expressionI10ScalarTypeDp10IndexTypesEERR13ESConstructor" title="Link to this definition"></a><br /></dt>
<dd><p>Inspect an expression <a class="reference internal" href="#_CPPv4I00EN10libcommute13hilbert_space13hilbert_spaceERKN10libcommute10expressionI10ScalarTypeDp10IndexTypesEERR13ESConstructor" title="libcommute::hilbert_space::hilbert_space::expr"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">expr</span></code></a> and collect all elementary spaces
associated with algebra generators found in <a class="reference internal" href="#_CPPv4I00EN10libcommute13hilbert_space13hilbert_spaceERKN10libcommute10expressionI10ScalarTypeDp10IndexTypesEERR13ESConstructor" title="libcommute::hilbert_space::hilbert_space::expr"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">expr</span></code></a>.
Construction of the elementary spaces is performed by the functor
<a class="reference internal" href="#_CPPv4I00EN10libcommute13hilbert_space13hilbert_spaceERKN10libcommute10expressionI10ScalarTypeDp10IndexTypesEERR13ESConstructor" title="libcommute::hilbert_space::hilbert_space::es_constr"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">es_constr</span></code></a>.
Throws <a class="reference internal" href="#_CPPv4N10libcommute13hilbert_space21hilbert_space_too_bigE" title="libcommute::hilbert_space::hilbert_space_too_big"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">hilbert_space_too_big</span></code></a> if all collected elementary spaces
together would exceed the 63-bit limit of the basis state index.</p>
</dd></dl>

<p class="rubric">Copy/move-constructors and assignments</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute13hilbert_space13hilbert_spaceERK13hilbert_space">
<span id="_CPPv3N10libcommute13hilbert_space13hilbert_spaceERK13hilbert_space"></span><span id="_CPPv2N10libcommute13hilbert_space13hilbert_spaceERK13hilbert_space"></span><span id="libcommute::hilbert_space::hilbert_space__hilbert_spaceCR"></span><span class="sig-name descname"><span class="n"><span class="pre">hilbert_space</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N10libcommute13hilbert_space13hilbert_spaceERK13hilbert_space" title="libcommute::hilbert_space::hilbert_space"><span class="n"><span class="pre">hilbert_space</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10libcommute13hilbert_space13hilbert_spaceERK13hilbert_space" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute13hilbert_space13hilbert_spaceERR13hilbert_space">
<span id="_CPPv3N10libcommute13hilbert_space13hilbert_spaceERR13hilbert_space"></span><span id="_CPPv2N10libcommute13hilbert_space13hilbert_spaceERR13hilbert_space"></span><span id="libcommute::hilbert_space::hilbert_space__hilbert_spaceRR"></span><span class="sig-name descname"><span class="n"><span class="pre">hilbert_space</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N10libcommute13hilbert_space13hilbert_spaceERR13hilbert_space" title="libcommute::hilbert_space::hilbert_space"><span class="n"><span class="pre">hilbert_space</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N10libcommute13hilbert_space13hilbert_spaceERR13hilbert_space" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute13hilbert_spaceaSERK13hilbert_space">
<span id="_CPPv3N10libcommute13hilbert_spaceaSERK13hilbert_space"></span><span id="_CPPv2N10libcommute13hilbert_spaceaSERK13hilbert_space"></span><span id="libcommute::hilbert_space::assign-operator__hilbert_spaceCR"></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><span class="n"><span class="pre">hilbert_space</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><span class="n"><span class="pre">hilbert_space</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10libcommute13hilbert_spaceaSERK13hilbert_space" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute13hilbert_spaceaSERR13hilbert_space">
<span id="_CPPv3N10libcommute13hilbert_spaceaSERR13hilbert_space"></span><span id="_CPPv2N10libcommute13hilbert_spaceaSERR13hilbert_space"></span><span id="libcommute::hilbert_space::assign-operator__hilbert_spaceRR"></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><span class="n"><span class="pre">hilbert_space</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><span class="n"><span class="pre">hilbert_space</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N10libcommute13hilbert_spaceaSERR13hilbert_space" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<p class="rubric">Other methods and friend functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute13hilbert_spaceeqERK13hilbert_spaceRK13hilbert_space">
<span id="_CPPv3N10libcommute13hilbert_spaceeqERK13hilbert_spaceRK13hilbert_space"></span><span id="_CPPv2N10libcommute13hilbert_spaceeqERK13hilbert_spaceRK13hilbert_space"></span><span id="libcommute::hilbert_space::eq-operator__hilbert_spaceCR.hilbert_spaceCR"></span><span class="k"><span class="pre">friend</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">==</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><span class="n"><span class="pre">hilbert_space</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">hs1</span></span>, <a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><span class="n"><span class="pre">hilbert_space</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">hs2</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10libcommute13hilbert_spaceeqERK13hilbert_spaceRK13hilbert_space" title="Link to this definition"></a><br /></dt>
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute13hilbert_spaceneERK13hilbert_spaceRK13hilbert_space">
<span id="_CPPv3N10libcommute13hilbert_spaceneERK13hilbert_spaceRK13hilbert_space"></span><span id="_CPPv2N10libcommute13hilbert_spaceneERK13hilbert_spaceRK13hilbert_space"></span><span id="libcommute::hilbert_space::neq-operator__hilbert_spaceCR.hilbert_spaceCR"></span><span class="k"><span class="pre">friend</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">!=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><span class="n"><span class="pre">hilbert_space</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">hs1</span></span>, <a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><span class="n"><span class="pre">hilbert_space</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">hs2</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10libcommute13hilbert_spaceneERK13hilbert_spaceRK13hilbert_space" title="Link to this definition"></a><br /></dt>
<dd><p>Check that two Hilbert spaces have an identical/different structure.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute13hilbert_space3addERK16elementary_spaceIDp10IndexTypesE">
<span id="_CPPv3N10libcommute13hilbert_space3addERK16elementary_spaceIDp10IndexTypesE"></span><span id="_CPPv2N10libcommute13hilbert_space3addERK16elementary_spaceIDp10IndexTypesE"></span><span id="libcommute::hilbert_space::add__elementary_space:IndexTypesDp:CR"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">add</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10libcommute13hilbert_space3addERK16elementary_spaceIDp10IndexTypesE" title="Link to this definition"></a><br /></dt>
<dd><p>Insert a new elementary space into the product. Throws
<a class="reference internal" href="#_CPPv4N10libcommute13hilbert_space23elementary_space_existsE" title="libcommute::hilbert_space::elementary_space_exists"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">elementary_space_exists</span></code></a> if an elementary space equivalent to
<a class="reference internal" href="#_CPPv4N10libcommute13hilbert_space3addERK16elementary_spaceIDp10IndexTypesE" title="libcommute::hilbert_space::add::es"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">es</span></code></a> is already part of the product.
Throws <a class="reference internal" href="#_CPPv4N10libcommute13hilbert_space21hilbert_space_too_bigE" title="libcommute::hilbert_space::hilbert_space_too_big"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">hilbert_space_too_big</span></code></a> if adding <a class="reference internal" href="#_CPPv4N10libcommute13hilbert_space3addERK16elementary_spaceIDp10IndexTypesE" title="libcommute::hilbert_space::add::es"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">es</span></code></a> into the product
would exceed the 63-bit limit of the basis state index.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute13hilbert_space3hasERK16elementary_spaceIDp10IndexTypesE">
<span id="_CPPv3NK10libcommute13hilbert_space3hasERK16elementary_spaceIDp10IndexTypesE"></span><span id="_CPPv2NK10libcommute13hilbert_space3hasERK16elementary_spaceIDp10IndexTypesE"></span><span id="libcommute::hilbert_space::has__elementary_space:IndexTypesDp:CRC"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">has</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK10libcommute13hilbert_space3hasERK16elementary_spaceIDp10IndexTypesE" title="Link to this definition"></a><br /></dt>
<dd><p>Is elementary space <a class="reference internal" href="#_CPPv4NK10libcommute13hilbert_space3hasERK16elementary_spaceIDp10IndexTypesE" title="libcommute::hilbert_space::has::es"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">es</span></code></a> part of the product?</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute13hilbert_space5indexERK16elementary_spaceIDp10IndexTypesE">
<span id="_CPPv3NK10libcommute13hilbert_space5indexERK16elementary_spaceIDp10IndexTypesE"></span><span id="_CPPv2NK10libcommute13hilbert_space5indexERK16elementary_spaceIDp10IndexTypesE"></span><span id="libcommute::hilbert_space::index__elementary_space:IndexTypesDp:CRC"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK10libcommute13hilbert_space5indexERK16elementary_spaceIDp10IndexTypesE" title="Link to this definition"></a><br /></dt>
<dd><p>Position of a given elementary space in the product.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute13hilbert_space3dimERK16elementary_spaceIDp10IndexTypesE">
<span id="_CPPv3NK10libcommute13hilbert_space3dimERK16elementary_spaceIDp10IndexTypesE"></span><span id="_CPPv2NK10libcommute13hilbert_space3dimERK16elementary_spaceIDp10IndexTypesE"></span><span id="libcommute::hilbert_space::dim__elementary_space:IndexTypesDp:CRC"></span><a class="reference internal" href="state_vector.html#_CPPv4N10libcommute13sv_index_typeE" title="libcommute::sv_index_type"><span class="n"><span class="pre">sv_index_type</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dim</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK10libcommute13hilbert_space3dimERK16elementary_spaceIDp10IndexTypesE" title="Link to this definition"></a><br /></dt>
<dd><p>Returns the dimension of the elementary space <a class="reference internal" href="#_CPPv4NK10libcommute13hilbert_space3dimERK16elementary_spaceIDp10IndexTypesE" title="libcommute::hilbert_space::dim::es"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">es</span></code></a>.
Throws <a class="reference internal" href="#_CPPv4N10libcommute13hilbert_space26elementary_space_not_foundE" title="libcommute::hilbert_space::elementary_space_not_found"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">elementary_space_not_found</span></code></a> if <a class="reference internal" href="#_CPPv4NK10libcommute13hilbert_space3dimERK16elementary_spaceIDp10IndexTypesE" title="libcommute::hilbert_space::dim::es"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">es</span></code></a> is not part of
the product.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute13hilbert_space9bit_rangeERK16elementary_spaceIDp10IndexTypesE">
<span id="_CPPv3NK10libcommute13hilbert_space9bit_rangeERK16elementary_spaceIDp10IndexTypesE"></span><span id="_CPPv2NK10libcommute13hilbert_space9bit_rangeERK16elementary_spaceIDp10IndexTypesE"></span><span id="libcommute::hilbert_space::bit_range__elementary_space:IndexTypesDp:CRC"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">bit_range</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK10libcommute13hilbert_space9bit_rangeERK16elementary_spaceIDp10IndexTypesE" title="Link to this definition"></a><br /></dt>
<dd><p>Returns the range of bits in the binary representation of a
basis state index that is occupied by the elementary space <a class="reference internal" href="#_CPPv4NK10libcommute13hilbert_space9bit_rangeERK16elementary_spaceIDp10IndexTypesE" title="libcommute::hilbert_space::bit_range::es"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">es</span></code></a>.
The range is returned as a pair (first_bit, last_bit).
Throws <a class="reference internal" href="#_CPPv4N10libcommute13hilbert_space26elementary_space_not_foundE" title="libcommute::hilbert_space::elementary_space_not_found"><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">elementary_space_not_found</span></code></a> if <a class="reference internal" href="#_CPPv4NK10libcommute13hilbert_space9bit_rangeERK16elementary_spaceIDp10IndexTypesE" title="libcommute::hilbert_space::bit_range::es"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">es</span></code></a> is not part of
the product.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK10libcommute13hilbert_space24foreach_elementary_spaceEvRR7Functor">
<span id="_CPPv3I0ENK10libcommute13hilbert_space24foreach_elementary_spaceERR7Functor"></span><span id="_CPPv2I0ENK10libcommute13hilbert_space24foreach_elementary_spaceERR7Functor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Functor</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">foreach_elementary_space</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0ENK10libcommute13hilbert_space24foreach_elementary_spaceEvRR7Functor" title="libcommute::hilbert_space::foreach_elementary_space::Functor"><span class="n"><span class="pre">Functor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">f</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK10libcommute13hilbert_space24foreach_elementary_spaceEvRR7Functor" title="Link to this definition"></a><br /></dt>
<dd><p>Successively apply a functor <a class="reference internal" href="#_CPPv4I0ENK10libcommute13hilbert_space24foreach_elementary_spaceEvRR7Functor" title="libcommute::hilbert_space::foreach_elementary_space::f"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">f</span></code></a> to all elementary spaces
in the product. <a class="reference internal" href="#_CPPv4I0ENK10libcommute13hilbert_space24foreach_elementary_spaceEvRR7Functor" title="libcommute::hilbert_space::foreach_elementary_space::f"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">f</span></code></a> must accept a constant reference to
<a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">elementary_space</span></code></a>.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute13hilbert_space11has_algebraEi">
<span id="_CPPv3NK10libcommute13hilbert_space11has_algebraEi"></span><span id="_CPPv2NK10libcommute13hilbert_space11has_algebraEi"></span><span id="libcommute::hilbert_space::has_algebra__iC"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">has_algebra</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">algebra_id</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK10libcommute13hilbert_space11has_algebraEi" title="Link to this definition"></a><br /></dt>
<dd><p>Is an elementary space with a given algebra ID found in this Hilbert space?</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute13hilbert_space17algebra_bit_rangeEi">
<span id="_CPPv3NK10libcommute13hilbert_space17algebra_bit_rangeEi"></span><span id="_CPPv2NK10libcommute13hilbert_space17algebra_bit_rangeEi"></span><span id="libcommute::hilbert_space::algebra_bit_range__iC"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">algebra_bit_range</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">algebra_id</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK10libcommute13hilbert_space17algebra_bit_rangeEi" title="Link to this definition"></a><br /></dt>
<dd><p>Return the range of bits in the binary representation of a basis state
index that is occupied by all elementary spaces with a given
<a class="reference internal" href="../expression/generator.html#generator"><span class="std std-ref">algebra ID</span></a>. The range is always contiguous because
elementary spaces with the same algebra ID are grouped together in the
product. Throws <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">std::runtime_error</span></code> if there is no elementary spaces
with the given ID in the product.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute13hilbert_space4sizeEv">
<span id="_CPPv3NK10libcommute13hilbert_space4sizeEv"></span><span id="_CPPv2NK10libcommute13hilbert_space4sizeEv"></span><span id="libcommute::hilbert_space::sizeC"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK10libcommute13hilbert_space4sizeEv" title="Link to this definition"></a><br /></dt>
<dd><p>The number of elementary spaces in the product.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute13hilbert_space12total_n_bitsEv">
<span id="_CPPv3NK10libcommute13hilbert_space12total_n_bitsEv"></span><span id="_CPPv2NK10libcommute13hilbert_space12total_n_bitsEv"></span><span id="libcommute::hilbert_space::total_n_bitsC"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">total_n_bits</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK10libcommute13hilbert_space12total_n_bitsEv" title="Link to this definition"></a><br /></dt>
<dd><p>The total number of used bits in the binary representation of a basis state
index.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute13hilbert_space3dimEv">
<span id="_CPPv3NK10libcommute13hilbert_space3dimEv"></span><span id="_CPPv2NK10libcommute13hilbert_space3dimEv"></span><span id="libcommute::hilbert_space::dimC"></span><a class="reference internal" href="state_vector.html#_CPPv4N10libcommute13sv_index_typeE" title="libcommute::sv_index_type"><span class="n"><span class="pre">sv_index_type</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dim</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK10libcommute13hilbert_space3dimEv" title="Link to this definition"></a><br /></dt>
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute13hilbert_space7get_dimERK13hilbert_space">
<span id="_CPPv3N10libcommute13hilbert_space7get_dimERK13hilbert_space"></span><span id="_CPPv2N10libcommute13hilbert_space7get_dimERK13hilbert_space"></span><span id="libcommute::hilbert_space::get_dim__hilbert_spaceCR"></span><span class="k"><span class="pre">friend</span></span><span class="w"> </span><a class="reference internal" href="state_vector.html#_CPPv4N10libcommute13sv_index_typeE" title="libcommute::sv_index_type"><span class="n"><span class="pre">sv_index_type</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_dim</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><span class="n"><span class="pre">hilbert_space</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">hs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10libcommute13hilbert_space7get_dimERK13hilbert_space" title="Link to this definition"></a><br /></dt>
<dd><p>The dimension of this Hilbert space computed as a product of dimensions
of the elementary spaces.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute13hilbert_space8vec_sizeEv">
<span id="_CPPv3NK10libcommute13hilbert_space8vec_sizeEv"></span><span id="_CPPv2NK10libcommute13hilbert_space8vec_sizeEv"></span><span id="libcommute::hilbert_space::vec_sizeC"></span><a class="reference internal" href="state_vector.html#_CPPv4N10libcommute13sv_index_typeE" title="libcommute::sv_index_type"><span class="n"><span class="pre">sv_index_type</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vec_size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK10libcommute13hilbert_space8vec_sizeEv" title="Link to this definition"></a><br /></dt>
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute13hilbert_space12get_vec_sizeERK13hilbert_space">
<span id="_CPPv3N10libcommute13hilbert_space12get_vec_sizeERK13hilbert_space"></span><span id="_CPPv2N10libcommute13hilbert_space12get_vec_sizeERK13hilbert_space"></span><span id="libcommute::hilbert_space::get_vec_size__hilbert_spaceCR"></span><span class="k"><span class="pre">friend</span></span><span class="w"> </span><a class="reference internal" href="state_vector.html#_CPPv4N10libcommute13sv_index_typeE" title="libcommute::sv_index_type"><span class="n"><span class="pre">sv_index_type</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_vec_size</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><span class="n"><span class="pre">hilbert_space</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">hs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10libcommute13hilbert_space12get_vec_sizeERK13hilbert_space" title="Link to this definition"></a><br /></dt>
<dd><p>Minimal size of a <a class="reference internal" href="state_vector.html#state-vector"><span class="std std-ref">state vector</span></a> object compatible with
this Hilbert space. This size is derived from the dimensions of the
elementary spaces <span class="math notranslate nohighlight">\(\mathcal{H}_i\)</span> as
<span class="math notranslate nohighlight">\(2^{\sum_{i=1}^N \lceil\log_2(\dim(\mathcal{H_i}))\rceil}\)</span>.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute13hilbert_space9is_sparseEv">
<span id="_CPPv3NK10libcommute13hilbert_space9is_sparseEv"></span><span id="_CPPv2NK10libcommute13hilbert_space9is_sparseEv"></span><span id="libcommute::hilbert_space::is_sparseC"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">is_sparse</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK10libcommute13hilbert_space9is_sparseEv" title="Link to this definition"></a><br /></dt>
<dd><p>Does this Hilbert space have a non-power-of-two dimension?</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN10libcommute13hilbert_space7foreachEvRK13hilbert_spaceRR7Functor">
<span id="_CPPv3I0EN10libcommute13hilbert_space7foreachERK13hilbert_spaceRR7Functor"></span><span id="_CPPv2I0EN10libcommute13hilbert_space7foreachERK13hilbert_spaceRR7Functor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Functor</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="k"><span class="pre">friend</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">foreach</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><span class="n"><span class="pre">hilbert_space</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">hs</span></span>, <a class="reference internal" href="#_CPPv4I0EN10libcommute13hilbert_space7foreachEvRK13hilbert_spaceRR7Functor" title="libcommute::hilbert_space::foreach::Functor"><span class="n"><span class="pre">Functor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN10libcommute13hilbert_space7foreachEvRK13hilbert_spaceRR7Functor" title="Link to this definition"></a><br /></dt>
<dd><p>Apply functor <a class="reference internal" href="#_CPPv4I0EN10libcommute13hilbert_space7foreachEvRK13hilbert_spaceRR7Functor" title="libcommute::hilbert_space::foreach::f"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">f</span></code></a> to all basis state indices in <a class="reference internal" href="#_CPPv4I0EN10libcommute13hilbert_space7foreachEvRK13hilbert_spaceRR7Functor" title="libcommute::hilbert_space::foreach::hs"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">hs</span></code></a>.
<a class="reference internal" href="#_CPPv4I0EN10libcommute13hilbert_space7foreachEvRK13hilbert_spaceRR7Functor" title="libcommute::hilbert_space::foreach::f"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">f</span></code></a> must accept one argument of type <a class="reference internal" href="state_vector.html#_CPPv4N10libcommute13sv_index_typeE" title="libcommute::sv_index_type"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">sv_index_type</span></code></a>.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute13hilbert_space17basis_state_indexERK16elementary_spaceIDp10IndexTypesE13sv_index_type">
<span id="_CPPv3N10libcommute13hilbert_space17basis_state_indexERK16elementary_spaceIDp10IndexTypesE13sv_index_type"></span><span id="_CPPv2N10libcommute13hilbert_space17basis_state_indexERK16elementary_spaceIDp10IndexTypesE13sv_index_type"></span><span id="libcommute::hilbert_space::basis_state_index__elementary_space:IndexTypesDp:CR.sv_index_type"></span><a class="reference internal" href="state_vector.html#_CPPv4N10libcommute13sv_index_typeE" title="libcommute::sv_index_type"><span class="n"><span class="pre">sv_index_type</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">basis_state_index</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es</span></span>, <a class="reference internal" href="state_vector.html#_CPPv4N10libcommute13sv_index_typeE" title="libcommute::sv_index_type"><span class="n"><span class="pre">sv_index_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10libcommute13hilbert_space17basis_state_indexERK16elementary_spaceIDp10IndexTypesE13sv_index_type" title="Link to this definition"></a><br /></dt>
<dd><p>Given an elementary space <a class="reference internal" href="#_CPPv4N10libcommute13hilbert_space17basis_state_indexERK16elementary_spaceIDp10IndexTypesE13sv_index_type" title="libcommute::hilbert_space::basis_state_index::es"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">es</span></code></a> and an index <a class="reference internal" href="#_CPPv4N10libcommute13hilbert_space17basis_state_indexERK16elementary_spaceIDp10IndexTypesE13sv_index_type" title="libcommute::hilbert_space::basis_state_index::n"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">n</span></code></a> of a basis state
within it, return the corresponding basis state index within the full
Hilbert space.</p>
</dd></dl>

<p class="rubric">Exception types</p>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute13hilbert_space23elementary_space_existsE">
<span id="_CPPv3N10libcommute13hilbert_space23elementary_space_existsE"></span><span id="_CPPv2N10libcommute13hilbert_space23elementary_space_existsE"></span><span id="libcommute::hilbert_space::elementary_space_exists"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">elementary_space_exists</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">runtime_error</span></span><a class="headerlink" href="#_CPPv4N10libcommute13hilbert_space23elementary_space_existsE" title="Link to this definition"></a><br /></dt>
<dd><p>Thrown when one tries to add an elementary space that is already part of
the product.</p>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute13hilbert_space26elementary_space_not_foundE">
<span id="_CPPv3N10libcommute13hilbert_space26elementary_space_not_foundE"></span><span id="_CPPv2N10libcommute13hilbert_space26elementary_space_not_foundE"></span><span id="libcommute::hilbert_space::elementary_space_not_found"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">elementary_space_not_found</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">runtime_error</span></span><a class="headerlink" href="#_CPPv4N10libcommute13hilbert_space26elementary_space_not_foundE" title="Link to this definition"></a><br /></dt>
<dd><p>Given elementary space is not part of the product.</p>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute13hilbert_space21hilbert_space_too_bigE">
<span id="_CPPv3N10libcommute13hilbert_space21hilbert_space_too_bigE"></span><span id="_CPPv2N10libcommute13hilbert_space21hilbert_space_too_bigE"></span><span id="libcommute::hilbert_space::hilbert_space_too_big"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hilbert_space_too_big</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">runtime_error</span></span><a class="headerlink" href="#_CPPv4N10libcommute13hilbert_space21hilbert_space_too_bigE" title="Link to this definition"></a><br /></dt>
<dd><p>The total basis state index size exceeds 63 bits.</p>
</dd></dl>

</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0Dp0EN10libcommute18make_hilbert_spaceE13hilbert_spaceIDp10IndexTypesERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor">
<span id="_CPPv3I0Dp0EN10libcommute18make_hilbert_spaceERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor"></span><span id="_CPPv2I0Dp0EN10libcommute18make_hilbert_spaceERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ScalarType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">IndexTypes</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ESConstructor</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N10libcommute22default_es_constructorE" title="libcommute::default_es_constructor"><span class="n"><span class="pre">default_es_constructor</span></span></a><span class="p"><span class="pre">&gt;</span></span><br /><a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><span class="n"><span class="pre">hilbert_space</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0Dp0EN10libcommute18make_hilbert_spaceE13hilbert_spaceIDp10IndexTypesERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor" title="libcommute::make_hilbert_space::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">make_hilbert_space</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../expression/expression.html#_CPPv4I0DpEN10libcommute10expressionE" title="libcommute::expression"><span class="n"><span class="pre">expression</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0Dp0EN10libcommute18make_hilbert_spaceE13hilbert_spaceIDp10IndexTypesERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor" title="libcommute::make_hilbert_space::ScalarType"><span class="n"><span class="pre">ScalarType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0Dp0EN10libcommute18make_hilbert_spaceE13hilbert_spaceIDp10IndexTypesERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor" title="libcommute::make_hilbert_space::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">expr</span></span>, <a class="reference internal" href="#_CPPv4I0Dp0EN10libcommute18make_hilbert_spaceE13hilbert_spaceIDp10IndexTypesERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor" title="libcommute::make_hilbert_space::ESConstructor"><span class="n"><span class="pre">ESConstructor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es_constr</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="p"><span class="pre">}</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0Dp0EN10libcommute18make_hilbert_spaceE13hilbert_spaceIDp10IndexTypesERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor" title="Link to this definition"></a><br /></dt>
<dd><p><em>Defined in &lt;libcommute/loperator/hilbert_space.hpp&gt;</em></p>
<p>A helper factory function that constructs an <a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">hilbert_space</span></code></a> instance
from an expression <a class="reference internal" href="#_CPPv4I0Dp0EN10libcommute18make_hilbert_spaceE13hilbert_spaceIDp10IndexTypesERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor" title="libcommute::make_hilbert_space::expr"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">expr</span></code></a> using an
<a class="reference internal" href="#es-constructor"><span class="std std-ref">elementary space constructor</span></a>. This function is a
more convenient equivalent of one of <a class="reference internal" href="#_CPPv4IDpEN10libcommute13hilbert_spaceE" title="libcommute::hilbert_space"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">hilbert_space</span></code></a>’s constructors.</p>
</dd></dl>

<section id="elementary-spaces">
<span id="id1"></span><h2>Elementary spaces<a class="headerlink" href="#elementary-spaces" title="Link to this heading"></a></h2>
<p>An elementary space has an <a class="reference internal" href="../expression/generator.html#generator"><span class="std std-ref">algebra ID</span></a> assigned to it and
carries a tuple of indices. Together, these two pieces of information link
the elementary space to algebra generators acting in it. Similarly to the
generator objects, elementary spaces are assumed to be immutable.</p>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN10libcommute16elementary_spaceE">
<span id="_CPPv3IDpEN10libcommute16elementary_spaceE"></span><span id="_CPPv2IDpEN10libcommute16elementary_spaceE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">IndexTypes</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">elementary_space</span></span></span><a class="headerlink" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="Link to this definition"></a><br /></dt>
<dd><p><em>Defined in &lt;libcommute/loperator/elementary_space.hpp&gt;</em></p>
<p>Abstract base class for elementary spaces. <a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space::IndexTypes"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">IndexTypes</span></code></a> are index types
of the associated algebra generators.</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute16elementary_space11index_typesE">
<span id="_CPPv3N10libcommute16elementary_space11index_typesE"></span><span id="_CPPv2N10libcommute16elementary_space11index_typesE"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_types</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">tuple</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N10libcommute16elementary_space11index_typesE" title="Link to this definition"></a><br /></dt>
<dd><p>Index tuple type.</p>
</dd></dl>

<p class="rubric">Constructors</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN10libcommute16elementary_space16elementary_spaceEDpRR4Args">
<span id="_CPPv3IDpEN10libcommute16elementary_space16elementary_spaceEDpRR4Args"></span><span id="_CPPv2IDpEN10libcommute16elementary_space16elementary_spaceEDpRR4Args"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">Args</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="sig-name descname"><span class="n"><span class="pre">elementary_space</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_space16elementary_spaceEDpRR4Args" title="libcommute::elementary_space::elementary_space::Args"><span class="n"><span class="pre">Args</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indices</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IDpEN10libcommute16elementary_space16elementary_spaceEDpRR4Args" title="Link to this definition"></a><br /></dt>
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute16elementary_space16elementary_spaceERK11index_types">
<span id="_CPPv3N10libcommute16elementary_space16elementary_spaceERK11index_types"></span><span id="_CPPv2N10libcommute16elementary_space16elementary_spaceERK11index_types"></span><span id="libcommute::elementary_space::elementary_space__index_typesCR"></span><span class="sig-name descname"><span class="n"><span class="pre">elementary_space</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N10libcommute16elementary_space11index_typesE" title="libcommute::elementary_space::index_types"><span class="n"><span class="pre">index_types</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">indices</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10libcommute16elementary_space16elementary_spaceERK11index_types" title="Link to this definition"></a><br /></dt>
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute16elementary_space16elementary_spaceERR11index_types">
<span id="_CPPv3N10libcommute16elementary_space16elementary_spaceERR11index_types"></span><span id="_CPPv2N10libcommute16elementary_space16elementary_spaceERR11index_types"></span><span id="libcommute::elementary_space::elementary_space__index_typesRR"></span><span class="sig-name descname"><span class="n"><span class="pre">elementary_space</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N10libcommute16elementary_space11index_typesE" title="libcommute::elementary_space::index_types"><span class="n"><span class="pre">index_types</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">indices</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10libcommute16elementary_space16elementary_spaceERR11index_types" title="Link to this definition"></a><br /></dt>
<dd><p>Construct from a list/tuple of indices.</p>
</dd></dl>

<p class="rubric">Copy/move-constructors, assignments and destructor</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute16elementary_space16elementary_spaceERK16elementary_space">
<span id="_CPPv3N10libcommute16elementary_space16elementary_spaceERK16elementary_space"></span><span id="_CPPv2N10libcommute16elementary_space16elementary_spaceERK16elementary_space"></span><span id="libcommute::elementary_space::elementary_space__elementary_spaceCR"></span><span class="sig-name descname"><span class="n"><span class="pre">elementary_space</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N10libcommute16elementary_space16elementary_spaceERK16elementary_space" title="libcommute::elementary_space::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N10libcommute16elementary_space16elementary_spaceERK16elementary_space" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute16elementary_space16elementary_spaceERR16elementary_space">
<span id="_CPPv3N10libcommute16elementary_space16elementary_spaceERR16elementary_space"></span><span id="_CPPv2N10libcommute16elementary_space16elementary_spaceERR16elementary_space"></span><span id="libcommute::elementary_space::elementary_space__elementary_spaceRR"></span><span class="sig-name descname"><span class="n"><span class="pre">elementary_space</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N10libcommute16elementary_space16elementary_spaceERR16elementary_space" title="libcommute::elementary_space::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N10libcommute16elementary_space16elementary_spaceERR16elementary_space" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute16elementary_spaceaSERK16elementary_space">
<span id="_CPPv3N10libcommute16elementary_spaceaSERK16elementary_space"></span><span id="_CPPv2N10libcommute16elementary_spaceaSERK16elementary_space"></span><span id="libcommute::elementary_space::assign-operator__elementary_spaceCR"></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N10libcommute16elementary_spaceaSERK16elementary_space" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute16elementary_spaceaSERR16elementary_space">
<span id="_CPPv3N10libcommute16elementary_spaceaSERR16elementary_space"></span><span id="_CPPv2N10libcommute16elementary_spaceaSERR16elementary_space"></span><span id="libcommute::elementary_space::assign-operator__elementary_spaceRR"></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N10libcommute16elementary_spaceaSERR16elementary_space" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute16elementary_spaceD0Ev">
<span id="_CPPv3N10libcommute16elementary_spaceD0Ev"></span><span id="_CPPv2N10libcommute16elementary_spaceD0Ev"></span><span id="libcommute::elementary_space::~elementary_space"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~elementary_space</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10libcommute16elementary_spaceD0Ev" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute16elementary_space5cloneEv">
<span id="_CPPv3NK10libcommute16elementary_space5cloneEv"></span><span id="_CPPv2NK10libcommute16elementary_space5cloneEv"></span><span id="libcommute::elementary_space::cloneC"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">unique_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">clone</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4NK10libcommute16elementary_space5cloneEv" title="Link to this definition"></a><br /></dt>
<dd><p>Virtual copy-constructor. Makes a copy of this elementary space managed by a
unique pointer.</p>
</dd></dl>

<p class="rubric">Algebra ID</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute16elementary_space10algebra_idEv">
<span id="_CPPv3NK10libcommute16elementary_space10algebra_idEv"></span><span id="_CPPv2NK10libcommute16elementary_space10algebra_idEv"></span><span id="libcommute::elementary_space::algebra_idC"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">algebra_id</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4NK10libcommute16elementary_space10algebra_idEv" title="Link to this definition"></a><br /></dt>
<dd><p><a class="reference internal" href="../expression/generator.html#generator"><span class="std std-ref">Algebra ID</span></a> of the generators associated with this
elementary space.</p>
</dd></dl>

<p class="rubric">Index sequence</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute16elementary_space7indicesEv">
<span id="_CPPv3NK10libcommute16elementary_space7indicesEv"></span><span id="_CPPv2NK10libcommute16elementary_space7indicesEv"></span><span id="libcommute::elementary_space::indicesC"></span><a class="reference internal" href="#_CPPv4N10libcommute16elementary_space11index_typesE" title="libcommute::elementary_space::index_types"><span class="n"><span class="pre">index_types</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">indices</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK10libcommute16elementary_space7indicesEv" title="Link to this definition"></a><br /></dt>
<dd><p>Read-only access to the index tuple carried by this elementary space.</p>
</dd></dl>

<p class="rubric">Ordering within a direct product</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute16elementary_space5equalERK16elementary_space">
<span id="_CPPv3NK10libcommute16elementary_space5equalERK16elementary_space"></span><span id="_CPPv2NK10libcommute16elementary_space5equalERK16elementary_space"></span><span id="libcommute::elementary_space::equal__elementary_spaceCRC"></span><span class="k"><span class="pre">protected</span></span><span class="w"> </span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">equal</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK10libcommute16elementary_space5equalERK16elementary_space" title="Link to this definition"></a><br /></dt>
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute16elementary_space4lessERK16elementary_space">
<span id="_CPPv3NK10libcommute16elementary_space4lessERK16elementary_space"></span><span id="_CPPv2NK10libcommute16elementary_space4lessERK16elementary_space"></span><span id="libcommute::elementary_space::less__elementary_spaceCRC"></span><span class="k"><span class="pre">protected</span></span><span class="w"> </span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">less</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK10libcommute16elementary_space4lessERK16elementary_space" title="Link to this definition"></a><br /></dt>
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute16elementary_space7greaterERK16elementary_space">
<span id="_CPPv3NK10libcommute16elementary_space7greaterERK16elementary_space"></span><span id="_CPPv2NK10libcommute16elementary_space7greaterERK16elementary_space"></span><span id="libcommute::elementary_space::greater__elementary_spaceCRC"></span><span class="k"><span class="pre">protected</span></span><span class="w"> </span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">greater</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK10libcommute16elementary_space7greaterERK16elementary_space" title="Link to this definition"></a><br /></dt>
<dd><p>These methods can be overridden by the derived classes to establish
the order of <a class="reference internal" href="#_CPPv4NK10libcommute16elementary_space7greaterERK16elementary_space" title="libcommute::elementary_space::greater::es"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">es</span></code></a> w.r.t. <code class="docutils literal notranslate"><span class="pre">*this</span></code> assuming both elementary spaces
are associated with the same algebra. The default implementation compares
index tuples of <code class="docutils literal notranslate"><span class="pre">*this</span></code> and <a class="reference internal" href="#_CPPv4NK10libcommute16elementary_space7greaterERK16elementary_space" title="libcommute::elementary_space::greater::es"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">es</span></code></a>.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute16elementary_spaceeqERK9generatorRK9generator">
<span id="_CPPv3N10libcommute16elementary_spaceeqERK9generatorRK9generator"></span><span id="_CPPv2N10libcommute16elementary_spaceeqERK9generatorRK9generator"></span><span id="libcommute::elementary_space::eq-operator__generatorCR.generatorCR"></span><span class="k"><span class="pre">friend</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">==</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../expression/generator.html#_CPPv4IDpEN10libcommute9generatorE" title="libcommute::generator"><span class="n"><span class="pre">generator</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es1</span></span>, <a class="reference internal" href="../expression/generator.html#_CPPv4IDpEN10libcommute9generatorE" title="libcommute::generator"><span class="n"><span class="pre">generator</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es2</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10libcommute16elementary_spaceeqERK9generatorRK9generator" title="Link to this definition"></a><br /></dt>
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute16elementary_spaceneERK9generatorRK9generator">
<span id="_CPPv3N10libcommute16elementary_spaceneERK9generatorRK9generator"></span><span id="_CPPv2N10libcommute16elementary_spaceneERK9generatorRK9generator"></span><span id="libcommute::elementary_space::neq-operator__generatorCR.generatorCR"></span><span class="k"><span class="pre">friend</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">!=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../expression/generator.html#_CPPv4IDpEN10libcommute9generatorE" title="libcommute::generator"><span class="n"><span class="pre">generator</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es1</span></span>, <a class="reference internal" href="../expression/generator.html#_CPPv4IDpEN10libcommute9generatorE" title="libcommute::generator"><span class="n"><span class="pre">generator</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es2</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10libcommute16elementary_spaceneERK9generatorRK9generator" title="Link to this definition"></a><br /></dt>
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute16elementary_spaceltERK9generatorRK9generator">
<span id="_CPPv3N10libcommute16elementary_spaceltERK9generatorRK9generator"></span><span id="_CPPv2N10libcommute16elementary_spaceltERK9generatorRK9generator"></span><span id="libcommute::elementary_space::lt-operator__generatorCR.generatorCR"></span><span class="k"><span class="pre">friend</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">&lt;</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../expression/generator.html#_CPPv4IDpEN10libcommute9generatorE" title="libcommute::generator"><span class="n"><span class="pre">generator</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es1</span></span>, <a class="reference internal" href="../expression/generator.html#_CPPv4IDpEN10libcommute9generatorE" title="libcommute::generator"><span class="n"><span class="pre">generator</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es2</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10libcommute16elementary_spaceltERK9generatorRK9generator" title="Link to this definition"></a><br /></dt>
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute16elementary_spacegtERK9generatorRK9generator">
<span id="_CPPv3N10libcommute16elementary_spacegtERK9generatorRK9generator"></span><span id="_CPPv2N10libcommute16elementary_spacegtERK9generatorRK9generator"></span><span id="libcommute::elementary_space::gt-operator__generatorCR.generatorCR"></span><span class="k"><span class="pre">friend</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">&gt;</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../expression/generator.html#_CPPv4IDpEN10libcommute9generatorE" title="libcommute::generator"><span class="n"><span class="pre">generator</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es1</span></span>, <a class="reference internal" href="../expression/generator.html#_CPPv4IDpEN10libcommute9generatorE" title="libcommute::generator"><span class="n"><span class="pre">generator</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">es2</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10libcommute16elementary_spacegtERK9generatorRK9generator" title="Link to this definition"></a><br /></dt>
<dd><p>Comparison operators for a pair of elementary spaces. First, they compare
algebra IDs of <a class="reference internal" href="#_CPPv4N10libcommute16elementary_spacegtERK9generatorRK9generator" title="libcommute::elementary_space::operator&gt;::es1"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">es1</span></code></a> and <a class="reference internal" href="#_CPPv4N10libcommute16elementary_spacegtERK9generatorRK9generator" title="libcommute::elementary_space::operator&gt;::es2"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">es2</span></code></a>. If those are equal,
<code class="docutils literal notranslate"><span class="pre">es1.equal(es2)</span></code>, <code class="docutils literal notranslate"><span class="pre">es1.less(es2)</span></code> or <code class="docutils literal notranslate"><span class="pre">es1.greater(es2)</span></code> is called.</p>
</dd></dl>

<p class="rubric">Dimension</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute16elementary_space3dimEv">
<span id="_CPPv3NK10libcommute16elementary_space3dimEv"></span><span id="_CPPv2NK10libcommute16elementary_space3dimEv"></span><span id="libcommute::elementary_space::dimC"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><a class="reference internal" href="state_vector.html#_CPPv4N10libcommute13sv_index_typeE" title="libcommute::sv_index_type"><span class="n"><span class="pre">sv_index_type</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dim</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4NK10libcommute16elementary_space3dimEv" title="Link to this definition"></a><br /></dt>
<dd><p>Dimension <span class="math notranslate nohighlight">\(d\)</span> of this elementary space.</p>
</dd></dl>

<p class="rubric">Binary representation of the basis state index</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK10libcommute16elementary_space6n_bitsEv">
<span id="_CPPv3NK10libcommute16elementary_space6n_bitsEv"></span><span id="_CPPv2NK10libcommute16elementary_space6n_bitsEv"></span><span id="libcommute::elementary_space::n_bitsC"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_bits</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4NK10libcommute16elementary_space6n_bitsEv" title="Link to this definition"></a><br /></dt>
<dd><p>The number of bits occupied by this elementary space,
<span class="math notranslate nohighlight">\(b = \lceil \log_2(d) \rceil\)</span>.</p>
</dd></dl>

</dd></dl>

<p class="rubric">Predefined concrete elementary space types</p>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN10libcommute24elementary_space_fermionE">
<span id="_CPPv3IDpEN10libcommute24elementary_space_fermionE"></span><span id="_CPPv2IDpEN10libcommute24elementary_space_fermionE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">IndexTypes</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">elementary_space_fermion</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute24elementary_space_fermionE" title="libcommute::elementary_space_fermion::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4IDpEN10libcommute24elementary_space_fermionE" title="Link to this definition"></a><br /></dt>
<dd><p><em>Defined in &lt;libcommute/loperator/elementary_space_fermion.hpp&gt;</em></p>
<p>An elementary space associated with fermionic algebra generators. This
elementary space is two-dimensional.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN10libcommute10libcommute14static_indices18make_space_fermionE24elementary_space_fermionIDp10IndexTypesEDpRR10IndexTypes">
<span id="_CPPv3IDpEN10libcommute10libcommute14static_indices18make_space_fermionEDpRR10IndexTypes"></span><span id="_CPPv2IDpEN10libcommute10libcommute14static_indices18make_space_fermionEDpRR10IndexTypes"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">IndexTypes</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><a class="reference internal" href="#_CPPv4IDpEN10libcommute24elementary_space_fermionE" title="libcommute::elementary_space_fermion"><span class="n"><span class="pre">elementary_space_fermion</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute10libcommute14static_indices18make_space_fermionE24elementary_space_fermionIDp10IndexTypesEDpRR10IndexTypes" title="libcommute::libcommute::static_indices::make_space_fermion::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">libcommute</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">static_indices</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">make_space_fermion</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute10libcommute14static_indices18make_space_fermionE24elementary_space_fermionIDp10IndexTypesEDpRR10IndexTypes" title="libcommute::libcommute::static_indices::make_space_fermion::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indices</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IDpEN10libcommute10libcommute14static_indices18make_space_fermionE24elementary_space_fermionIDp10IndexTypesEDpRR10IndexTypes" title="Link to this definition"></a><br /></dt>
<dd><p><em>Defined in &lt;libcommute/loperator/elementary_space_fermion.hpp&gt;</em></p>
<p>Make an elementary space associated with fermionic algebra generators
with given indices.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN10libcommute10libcommute15dynamic_indices18make_space_fermionE24elementary_space_fermionI11dyn_indicesEDpRR10IndexTypes">
<span id="_CPPv3IDpEN10libcommute10libcommute15dynamic_indices18make_space_fermionEDpRR10IndexTypes"></span><span id="_CPPv2IDpEN10libcommute10libcommute15dynamic_indices18make_space_fermionEDpRR10IndexTypes"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">IndexTypes</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><a class="reference internal" href="#_CPPv4IDpEN10libcommute24elementary_space_fermionE" title="libcommute::elementary_space_fermion"><span class="n"><span class="pre">elementary_space_fermion</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">dyn_indices</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">libcommute</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">dynamic_indices</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">make_space_fermion</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN10libcommute10libcommute15dynamic_indices18make_space_fermionE24elementary_space_fermionI11dyn_indicesEDpRR10IndexTypes" title="libcommute::libcommute::dynamic_indices::make_space_fermion::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indices</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IDpEN10libcommute10libcommute15dynamic_indices18make_space_fermionE24elementary_space_fermionI11dyn_indicesEDpRR10IndexTypes" title="Link to this definition"></a><br /></dt>
<dd><p><em>Defined in &lt;libcommute/loperator/elementary_space_fermion.hpp&gt;</em></p>
<p>Make an elementary space associated with fermionic algebra generators
with a given dynamic index sequence.</p>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN10libcommute22elementary_space_bosonE">
<span id="_CPPv3IDpEN10libcommute22elementary_space_bosonE"></span><span id="_CPPv2IDpEN10libcommute22elementary_space_bosonE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">IndexTypes</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">elementary_space_boson</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute22elementary_space_bosonE" title="libcommute::elementary_space_boson::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4IDpEN10libcommute22elementary_space_bosonE" title="Link to this definition"></a><br /></dt>
<dd><p><em>Defined in &lt;libcommute/loperator/elementary_space_boson.hpp&gt;</em></p>
<p>An elementary space associated with bosonic algebra generators. This
elementary space is truncated to an arbitrary fixed dimension.</p>
<p class="rubric">Part of the interface not inherited from / identical to
<a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">elementary_space</span></code></a>.</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN10libcommute22elementary_space_boson22elementary_space_bosonE13sv_index_typeDpRR4Args">
<span id="_CPPv3IDpEN10libcommute22elementary_space_boson22elementary_space_bosonE13sv_index_typeDpRR4Args"></span><span id="_CPPv2IDpEN10libcommute22elementary_space_boson22elementary_space_bosonE13sv_index_typeDpRR4Args"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">Args</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="sig-name descname"><span class="n"><span class="pre">elementary_space_boson</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="state_vector.html#_CPPv4N10libcommute13sv_index_typeE" title="libcommute::sv_index_type"><span class="n"><span class="pre">sv_index_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span>, <a class="reference internal" href="#_CPPv4IDpEN10libcommute22elementary_space_boson22elementary_space_bosonE13sv_index_typeDpRR4Args" title="libcommute::elementary_space_boson::elementary_space_boson::Args"><span class="n"><span class="pre">Args</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indices</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IDpEN10libcommute22elementary_space_boson22elementary_space_bosonE13sv_index_typeDpRR4Args" title="Link to this definition"></a><br /></dt>
<dd><p>Construct a bosonic elementary space of dimension <a class="reference internal" href="#_CPPv4IDpEN10libcommute22elementary_space_boson22elementary_space_bosonE13sv_index_typeDpRR4Args" title="libcommute::elementary_space_boson::elementary_space_boson::dim"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">dim</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN10libcommute10libcommute14static_indices16make_space_bosonE22elementary_space_bosonIDp10IndexTypesE13sv_index_typeDpRR10IndexTypes">
<span id="_CPPv3IDpEN10libcommute10libcommute14static_indices16make_space_bosonE13sv_index_typeDpRR10IndexTypes"></span><span id="_CPPv2IDpEN10libcommute10libcommute14static_indices16make_space_bosonE13sv_index_typeDpRR10IndexTypes"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">IndexTypes</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><a class="reference internal" href="#_CPPv4IDpEN10libcommute22elementary_space_bosonE" title="libcommute::elementary_space_boson"><span class="n"><span class="pre">elementary_space_boson</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute10libcommute14static_indices16make_space_bosonE22elementary_space_bosonIDp10IndexTypesE13sv_index_typeDpRR10IndexTypes" title="libcommute::libcommute::static_indices::make_space_boson::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">libcommute</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">static_indices</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">make_space_boson</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="state_vector.html#_CPPv4N10libcommute13sv_index_typeE" title="libcommute::sv_index_type"><span class="n"><span class="pre">sv_index_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span>, <a class="reference internal" href="#_CPPv4IDpEN10libcommute10libcommute14static_indices16make_space_bosonE22elementary_space_bosonIDp10IndexTypesE13sv_index_typeDpRR10IndexTypes" title="libcommute::libcommute::static_indices::make_space_boson::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indices</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IDpEN10libcommute10libcommute14static_indices16make_space_bosonE22elementary_space_bosonIDp10IndexTypesE13sv_index_typeDpRR10IndexTypes" title="Link to this definition"></a><br /></dt>
<dd><p><em>Defined in &lt;libcommute/loperator/elementary_space_boson.hpp&gt;</em></p>
<p>Make an elementary space of dimension <a class="reference internal" href="#_CPPv4IDpEN10libcommute10libcommute14static_indices16make_space_bosonE22elementary_space_bosonIDp10IndexTypesE13sv_index_typeDpRR10IndexTypes" title="libcommute::libcommute::static_indices::make_space_boson::dim"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">dim</span></code></a> associated with
bosonic algebra generators with given indices.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN10libcommute10libcommute15dynamic_indices16make_space_bosonE22elementary_space_bosonI11dyn_indicesE13sv_index_typeDpRR10IndexTypes">
<span id="_CPPv3IDpEN10libcommute10libcommute15dynamic_indices16make_space_bosonE13sv_index_typeDpRR10IndexTypes"></span><span id="_CPPv2IDpEN10libcommute10libcommute15dynamic_indices16make_space_bosonE13sv_index_typeDpRR10IndexTypes"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">IndexTypes</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><a class="reference internal" href="#_CPPv4IDpEN10libcommute22elementary_space_bosonE" title="libcommute::elementary_space_boson"><span class="n"><span class="pre">elementary_space_boson</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">dyn_indices</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">libcommute</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">dynamic_indices</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">make_space_boson</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="state_vector.html#_CPPv4N10libcommute13sv_index_typeE" title="libcommute::sv_index_type"><span class="n"><span class="pre">sv_index_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span>, <a class="reference internal" href="#_CPPv4IDpEN10libcommute10libcommute15dynamic_indices16make_space_bosonE22elementary_space_bosonI11dyn_indicesE13sv_index_typeDpRR10IndexTypes" title="libcommute::libcommute::dynamic_indices::make_space_boson::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indices</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IDpEN10libcommute10libcommute15dynamic_indices16make_space_bosonE22elementary_space_bosonI11dyn_indicesE13sv_index_typeDpRR10IndexTypes" title="Link to this definition"></a><br /></dt>
<dd><p><em>Defined in &lt;libcommute/loperator/elementary_space_boson.hpp&gt;</em></p>
<p>Make an elementary space of dimension <a class="reference internal" href="#_CPPv4IDpEN10libcommute10libcommute15dynamic_indices16make_space_bosonE22elementary_space_bosonI11dyn_indicesE13sv_index_typeDpRR10IndexTypes" title="libcommute::libcommute::dynamic_indices::make_space_boson::dim"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">dim</span></code></a> associated with
bosonic algebra generators with a given dynamic index sequence.</p>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN10libcommute21elementary_space_spinE">
<span id="_CPPv3IDpEN10libcommute21elementary_space_spinE"></span><span id="_CPPv2IDpEN10libcommute21elementary_space_spinE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">IndexTypes</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">elementary_space_spin</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><span class="n"><span class="pre">elementary_space</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute21elementary_space_spinE" title="libcommute::elementary_space_spin::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4IDpEN10libcommute21elementary_space_spinE" title="Link to this definition"></a><br /></dt>
<dd><p><em>Defined in &lt;libcommute/loperator/elementary_space_spin.hpp&gt;</em></p>
<p>An elementary space associated with spin algebra generators. Dimension of
this elementary space depends on spin <span class="math notranslate nohighlight">\(S\)</span>, and is equal to
<span class="math notranslate nohighlight">\(2S+1\)</span>.</p>
<p class="rubric">Part of the interface not inherited from / identical to
<a class="reference internal" href="#_CPPv4IDpEN10libcommute16elementary_spaceE" title="libcommute::elementary_space"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">elementary_space</span></code></a>.</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN10libcommute21elementary_space_spin21elementary_space_spinEdDpRR4Args">
<span id="_CPPv3IDpEN10libcommute21elementary_space_spin21elementary_space_spinEdDpRR4Args"></span><span id="_CPPv2IDpEN10libcommute21elementary_space_spin21elementary_space_spinEdDpRR4Args"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">Args</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="sig-name descname"><span class="n"><span class="pre">elementary_space_spin</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">spin</span></span>, <a class="reference internal" href="#_CPPv4IDpEN10libcommute21elementary_space_spin21elementary_space_spinEdDpRR4Args" title="libcommute::elementary_space_spin::elementary_space_spin::Args"><span class="n"><span class="pre">Args</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indices</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IDpEN10libcommute21elementary_space_spin21elementary_space_spinEdDpRR4Args" title="Link to this definition"></a><br /></dt>
<dd><p>Construct a spin elementary space with a given spin <span class="math notranslate nohighlight">\(S\)</span> = <a class="reference internal" href="#_CPPv4IDpEN10libcommute21elementary_space_spin21elementary_space_spinEdDpRR4Args" title="libcommute::elementary_space_spin::elementary_space_spin::spin"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">spin</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN10libcommute10libcommute14static_indices15make_space_spinE21elementary_space_spinIDp10IndexTypesEdDpRR10IndexTypes">
<span id="_CPPv3IDpEN10libcommute10libcommute14static_indices15make_space_spinEdDpRR10IndexTypes"></span><span id="_CPPv2IDpEN10libcommute10libcommute14static_indices15make_space_spinEdDpRR10IndexTypes"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">IndexTypes</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><a class="reference internal" href="#_CPPv4IDpEN10libcommute21elementary_space_spinE" title="libcommute::elementary_space_spin"><span class="n"><span class="pre">elementary_space_spin</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN10libcommute10libcommute14static_indices15make_space_spinE21elementary_space_spinIDp10IndexTypesEdDpRR10IndexTypes" title="libcommute::libcommute::static_indices::make_space_spin::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">libcommute</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">static_indices</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">make_space_spin</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">spin</span></span>, <a class="reference internal" href="#_CPPv4IDpEN10libcommute10libcommute14static_indices15make_space_spinE21elementary_space_spinIDp10IndexTypesEdDpRR10IndexTypes" title="libcommute::libcommute::static_indices::make_space_spin::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indices</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IDpEN10libcommute10libcommute14static_indices15make_space_spinE21elementary_space_spinIDp10IndexTypesEdDpRR10IndexTypes" title="Link to this definition"></a><br /></dt>
<dd><p><em>Defined in &lt;libcommute/loperator/elementary_space_spin.hpp&gt;</em></p>
<p>Make a spin elementary space with <span class="math notranslate nohighlight">\(S\)</span> = <a class="reference internal" href="#_CPPv4IDpEN10libcommute10libcommute14static_indices15make_space_spinE21elementary_space_spinIDp10IndexTypesEdDpRR10IndexTypes" title="libcommute::libcommute::static_indices::make_space_spin::spin"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">spin</span></code></a> and given indices.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN10libcommute10libcommute15dynamic_indices15make_space_spinE21elementary_space_spinI11dyn_indicesEdDpRR10IndexTypes">
<span id="_CPPv3IDpEN10libcommute10libcommute15dynamic_indices15make_space_spinEdDpRR10IndexTypes"></span><span id="_CPPv2IDpEN10libcommute10libcommute15dynamic_indices15make_space_spinEdDpRR10IndexTypes"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">IndexTypes</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><a class="reference internal" href="#_CPPv4IDpEN10libcommute21elementary_space_spinE" title="libcommute::elementary_space_spin"><span class="n"><span class="pre">elementary_space_spin</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">dyn_indices</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">libcommute</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">dynamic_indices</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">make_space_spin</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">spin</span></span>, <a class="reference internal" href="#_CPPv4IDpEN10libcommute10libcommute15dynamic_indices15make_space_spinE21elementary_space_spinI11dyn_indicesEdDpRR10IndexTypes" title="libcommute::libcommute::dynamic_indices::make_space_spin::IndexTypes"><span class="n"><span class="pre">IndexTypes</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indices</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IDpEN10libcommute10libcommute15dynamic_indices15make_space_spinE21elementary_space_spinI11dyn_indicesEdDpRR10IndexTypes" title="Link to this definition"></a><br /></dt>
<dd><p><em>Defined in &lt;libcommute/loperator/elementary_space_spin.hpp&gt;</em></p>
<p>Make a spin elementary space with <span class="math notranslate nohighlight">\(S\)</span> = <a class="reference internal" href="#_CPPv4IDpEN10libcommute10libcommute15dynamic_indices15make_space_spinE21elementary_space_spinI11dyn_indicesEdDpRR10IndexTypes" title="libcommute::libcommute::dynamic_indices::make_space_spin::spin"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">spin</span></code></a> and a given
dynamic index sequence.</p>
</dd></dl>

</section>
<section id="advanced-customization-of-automatic-hilbert-space-construction">
<span id="es-constructor"></span><h2>Advanced: Customization of automatic Hilbert space construction<a class="headerlink" href="#advanced-customization-of-automatic-hilbert-space-construction" title="Link to this heading"></a></h2>
<p><a class="reference internal" href="#_CPPv4I0Dp0EN10libcommute18make_hilbert_spaceE13hilbert_spaceIDp10IndexTypesERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor" title="libcommute::make_hilbert_space"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">make_hilbert_space()</span></code></a> delegates the task of translating algebra
generators into elementary spaces to the functor passed as its second (optional)
argument. It is possible to customize the translation process by giving
<a class="reference internal" href="#_CPPv4I0Dp0EN10libcommute18make_hilbert_spaceE13hilbert_spaceIDp10IndexTypesERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor" title="libcommute::make_hilbert_space"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">make_hilbert_space()</span></code></a> a callable object similar to the following one</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// A custom elementary space constructor object</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">my_es_constructor</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="p">...</span><span class="w"> </span><span class="n">IndexTypes</span><span class="o">&gt;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">elementary_space</span><span class="o">&lt;</span><span class="n">IndexTypes</span><span class="p">...</span><span class="o">&gt;&gt;</span>
<span class="w">  </span><span class="k">operator</span><span class="p">()(</span><span class="n">generator</span><span class="o">&lt;</span><span class="n">IndexTypes</span><span class="p">...</span><span class="o">&gt;</span><span class="w"> </span><span class="k">const</span><span class="o">&amp;</span><span class="w"> </span><span class="n">g</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//</span>
<span class="w">    </span><span class="c1">// Create an elementary space associated with &#39;g&#39; and return it</span>
<span class="w">    </span><span class="c1">// wrapped in a unique pointer.</span>
<span class="w">    </span><span class="c1">//</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Other members as needed ...</span>
<span class="p">};</span>
</pre></div>
</div>
<p>This approach gives total control over elementary space creation. It works best
when expressions to be translated do not mix too many algebras and the body
of <code class="docutils literal notranslate"><span class="pre">my_es_constructor::operator()</span></code> can be kept relatively simple.</p>
<p>Now imagine a different, more common situation, when expressions mix generators
of various predefined algebras as well as generators of a new user-defined
algebra <code class="docutils literal notranslate"><span class="pre">my_algebra</span></code>. It would be desirable to instruct
<a class="reference internal" href="#_CPPv4I0Dp0EN10libcommute18make_hilbert_spaceE13hilbert_spaceIDp10IndexTypesERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor" title="libcommute::make_hilbert_space"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">make_hilbert_space()</span></code></a> how to translate instances of
<code class="docutils literal notranslate"><span class="pre">generator_my_algebra</span></code> into <code class="docutils literal notranslate"><span class="pre">elementary_space_my_algebra</span></code> without
rewriting all the code needed to process the predefined generators. This goal
can be achieved in a few steps by means of a special utility class
<a class="reference internal" href="#_CPPv4I_DpiEN10libcommute14es_constructorE" title="libcommute::es_constructor"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">es_constructor</span></code></a>.</p>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I_DpiEN10libcommute14es_constructorE">
<span id="_CPPv3I_DpiEN10libcommute14es_constructorE"></span><span id="_CPPv2I_DpiEN10libcommute14es_constructorE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">...</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AlgebraIDs</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">es_constructor</span></span></span><a class="headerlink" href="#_CPPv4I_DpiEN10libcommute14es_constructorE" title="Link to this definition"></a><br /></dt>
<dd><p><em>Defined in &lt;libcommute/loperator/es_constructor.hpp&gt;</em></p>
</dd></dl>

<ul>
<li><p>Define a new algebra ID, e.g. <code class="docutils literal notranslate"><span class="pre">my_algebra_id</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// A unique integer &gt;=min_user_defined_algebra_id</span>
<span class="k">static</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">my_algebra_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p>Specialize class <a class="reference internal" href="#_CPPv4I_DpiEN10libcommute14es_constructorE" title="libcommute::es_constructor"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">libcommute::es_constructor</span></code></a> as follows</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">es_constructor</span><span class="o">&lt;</span><span class="n">my_algebra_id</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>

<span class="w">  </span><span class="n">es_constructor</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>

<span class="w">  </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="p">...</span><span class="w"> </span><span class="n">IndexTypes</span><span class="o">&gt;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">elementary_space</span><span class="o">&lt;</span><span class="n">IndexTypes</span><span class="p">...</span><span class="o">&gt;&gt;</span>
<span class="w">  </span><span class="k">operator</span><span class="p">()(</span><span class="n">generator</span><span class="o">&lt;</span><span class="n">IndexTypes</span><span class="p">...</span><span class="o">&gt;</span><span class="w"> </span><span class="k">const</span><span class="o">&amp;</span><span class="w"> </span><span class="n">g</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//</span>
<span class="w">    </span><span class="c1">// Create an elementary space associated with &#39;g&#39; and return it</span>
<span class="w">    </span><span class="c1">// wrapped in a unique pointer. This method will be called only for</span>
<span class="w">    </span><span class="c1">// the generators of the new algebra, i.e. only when</span>
<span class="w">    </span><span class="c1">// g.algebra_id() == my_algebra_id</span>
<span class="w">    </span><span class="c1">//</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">es_constructor</span></code> is obviously a valid elementary space
constructor for <code class="docutils literal notranslate"><span class="pre">my_algebra</span></code></p>
</li>
<li><p>Instantiate <a class="reference internal" href="#_CPPv4I_DpiEN10libcommute14es_constructorE" title="libcommute::es_constructor"><code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">es_constructor</span></code></a> with multiple template parameters
(algebra IDs).</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">es_constr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">es_constructor</span><span class="o">&lt;</span><span class="n">fermion</span><span class="p">,</span><span class="w"> </span><span class="n">spin</span><span class="p">,</span><span class="w"> </span><span class="n">my_algebra_id</span><span class="o">&gt;</span><span class="p">();</span>
</pre></div>
</div>
<p>Now, <code class="docutils literal notranslate"><span class="pre">es_constr</span></code> knows how to process
<a class="reference internal" href="../expression/generator.html#_CPPv4N10libcommute7fermionE" title="libcommute::fermion"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">fermionic</span></code></a>,
<a class="reference internal" href="../expression/generator.html#_CPPv4N10libcommute4spinE" title="libcommute::spin"><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">spin</span></code></a> and <code class="docutils literal notranslate"><span class="pre">my_algebra</span></code> generators.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The algebra IDs must come in the ascending order when used as
template parameters of <a class="reference internal" href="#_CPPv4I_DpiEN10libcommute14es_constructorE" title="libcommute::es_constructor"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">es_constructor</span></code></a>.</p>
</div>
</li>
<li><p>Finally, call <a class="reference internal" href="#_CPPv4I0Dp0EN10libcommute18make_hilbert_spaceE13hilbert_spaceIDp10IndexTypesERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor" title="libcommute::make_hilbert_space"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">make_hilbert_space()</span></code></a> with two arguments.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">hs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_hilbert_space</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span><span class="w"> </span><span class="n">es_constr</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
<p>It is worth noting that by default <a class="reference internal" href="#_CPPv4I0Dp0EN10libcommute18make_hilbert_spaceE13hilbert_spaceIDp10IndexTypesERK10expressionI10ScalarTypeDp10IndexTypesERR13ESConstructor" title="libcommute::make_hilbert_space"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">make_hilbert_space()</span></code></a> uses the
following constructor type as its second argument.</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute22default_es_constructorE">
<span id="_CPPv3N10libcommute22default_es_constructorE"></span><span id="_CPPv2N10libcommute22default_es_constructorE"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">default_es_constructor</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_DpiEN10libcommute14es_constructorE" title="libcommute::es_constructor"><span class="n"><span class="pre">es_constructor</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../expression/generator.html#_CPPv4N10libcommute7fermionE" title="libcommute::fermion"><span class="n"><span class="pre">fermion</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../expression/generator.html#_CPPv4N10libcommute4spinE" title="libcommute::spin"><span class="n"><span class="pre">spin</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N10libcommute22default_es_constructorE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<p>In other words, it recognizes only fermionic and spin generators, and throws
<code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">es_construction_failure</span></code> for all other algebra IDs. If there are
bosonic creation/annihilation operators found in the expression, one may
use another elementary space constructor,</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N10libcommute20boson_es_constructorE">
<span id="_CPPv3N10libcommute20boson_es_constructorE"></span><span id="_CPPv2N10libcommute20boson_es_constructorE"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">boson_es_constructor</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_DpiEN10libcommute14es_constructorE" title="libcommute::es_constructor"><span class="n"><span class="pre">es_constructor</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="../expression/generator.html#_CPPv4N10libcommute7fermionE" title="libcommute::fermion"><span class="n"><span class="pre">fermion</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../expression/generator.html#_CPPv4N10libcommute5bosonE" title="libcommute::boson"><span class="n"><span class="pre">boson</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="../expression/generator.html#_CPPv4N10libcommute4spinE" title="libcommute::spin"><span class="n"><span class="pre">spin</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N10libcommute20boson_es_constructorE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calling
<code class="docutils literal notranslate"><span class="pre">es_constructor&lt;ID1,</span> <span class="pre">ID2,</span> <span class="pre">...,</span> <span class="pre">IDN&gt;(arg1,</span> <span class="pre">arg2,</span> <span class="pre">...,</span> <span class="pre">argK)</span></code>
will internally construct a series of objects
<span class="cpp-expr sig sig-inline cpp"><a class="reference internal" href="#_CPPv4I_DpiEN10libcommute14es_constructorE" title="libcommute::es_constructor"><span class="n">es_constructor</span></a><span class="p">&lt;</span><span class="n">ID1</span><span class="p">&gt;</span></span>, <span class="cpp-expr sig sig-inline cpp"><a class="reference internal" href="#_CPPv4I_DpiEN10libcommute14es_constructorE" title="libcommute::es_constructor"><span class="n">es_constructor</span></a><span class="p">&lt;</span><span class="n">ID2</span><span class="p">&gt;</span></span>, …,
<span class="cpp-expr sig sig-inline cpp"><a class="reference internal" href="#_CPPv4I_DpiEN10libcommute14es_constructorE" title="libcommute::es_constructor"><span class="n">es_constructor</span></a><span class="p">&lt;</span><span class="n">IDN</span><span class="p">&gt;</span></span>. The arguments will be ‘fed’ into
constructors of the single-ID objects in order, <em>at most one
argument per constructor</em>. For example,
<span class="cpp-expr sig sig-inline cpp"><a class="reference internal" href="#_CPPv4I_DpiEN10libcommute14es_constructorE" title="libcommute::es_constructor"><span class="n">es_constructor</span></a><span class="p">&lt;</span><a class="reference internal" href="../expression/generator.html#_CPPv4N10libcommute7fermionE" title="libcommute::fermion"><span class="n">fermion</span></a><span class="p">,</span><span class="w"> </span><a class="reference internal" href="../expression/generator.html#_CPPv4N10libcommute5bosonE" title="libcommute::boson"><span class="n">boson</span></a><span class="p">,</span><span class="w"> </span><a class="reference internal" href="../expression/generator.html#_CPPv4N10libcommute4spinE" title="libcommute::spin"><span class="n">spin</span></a><span class="p">&gt;</span><span class="p">(</span><span class="m">16</span><span class="p">)</span></span> will call
<span class="cpp-expr sig sig-inline cpp"><a class="reference internal" href="#_CPPv4I_DpiEN10libcommute14es_constructorE" title="libcommute::es_constructor"><span class="n">es_constructor</span></a><span class="p">&lt;</span><a class="reference internal" href="../expression/generator.html#_CPPv4N10libcommute7fermionE" title="libcommute::fermion"><span class="n">fermion</span></a><span class="p">&gt;</span><span class="p">(</span><span class="p">)</span></span>,
<span class="cpp-expr sig sig-inline cpp"><a class="reference internal" href="#_CPPv4I_DpiEN10libcommute14es_constructorE" title="libcommute::es_constructor"><span class="n">es_constructor</span></a><span class="p">&lt;</span><a class="reference internal" href="../expression/generator.html#_CPPv4N10libcommute5bosonE" title="libcommute::boson"><span class="n">boson</span></a><span class="p">&gt;</span><span class="p">(</span><span class="m">16</span><span class="p">)</span></span> and
<span class="cpp-expr sig sig-inline cpp"><a class="reference internal" href="#_CPPv4I_DpiEN10libcommute14es_constructorE" title="libcommute::es_constructor"><span class="n">es_constructor</span></a><span class="p">&lt;</span><a class="reference internal" href="../expression/generator.html#_CPPv4N10libcommute4spinE" title="libcommute::spin"><span class="n">spin</span></a><span class="p">&gt;</span><span class="p">(</span><span class="p">)</span></span> because the bosonic constructor is the
first in the sequence accepting one argument.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="intro.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="loperator.html" class="btn btn-neutral float-right" title="Linear operators" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2025, Igor Krivenko.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>